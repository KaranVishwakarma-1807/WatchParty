<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Watch Party</title>
  <link rel="icon" href="assets/title.svg" type="image/svg+xml" />
  <link rel="stylesheet" href="watch-party.css" />
</head>
<body>
  <div class="ambient a"></div>
  <div class="ambient b"></div>

  <main class="shell">
    <header class="glass topbar">
      <h1>Watch Party</h1>
      <p id="statusText">Join a room to start.</p>
    </header>

    <section class="glass join-card">
      <label>
        Room ID
        <input id="roomInput" type="text" placeholder="movie-time" />
      </label>
      <label>
        Your Name
        <input id="nameInput" type="text" placeholder="Kookiee" />
      </label>
      <button id="joinBtn" type="button">Join Room</button>
      <p id="joinParticipantsText" class="join-participants">Participants: 0</p>
    </section>

    <section class="layout">
      <article class="glass player-card">
        <video id="videoPlayer" playsinline></video>
        <div id="youtubeContainer" class="youtube-container hidden">
          <div id="youtubePlayer"></div>
        </div>
        <div id="externalContainer" class="external-container hidden">
          <iframe id="externalFrame" title="External media" allowfullscreen referrerpolicy="no-referrer-when-downgrade"></iframe>
          <div id="externalFallback" class="external-fallback hidden">
            <p>Embedded playback may be blocked by this provider.</p>
            <a id="externalOpenLink" href="#" target="_blank" rel="noopener noreferrer">Open external page</a>
          </div>
        </div>
        <p id="videoTitle" class="video-title">No media selected yet.</p>

        <section class="controls">
          <button id="playPauseBtn" type="button">Play</button>
          <button id="muteBtn" type="button">Mute</button>
          <button id="fullscreenBtn" type="button">Fullscreen</button>
          <label>
            Speed
            <select id="speedSelect" title="Playback speed">
              <option value="0.5">0.5x</option>
              <option value="0.75">0.75x</option>
              <option value="1" selected>1x</option>
              <option value="1.25">1.25x</option>
              <option value="1.5">1.5x</option>
              <option value="1.75">1.75x</option>
              <option value="2">2x</option>
            </select>
          </label>
          <label>
            Subtitles
            <select id="subtitleSelect" title="Subtitle track">
              <option value="off">Off</option>
            </select>
          </label>
          <label>
            Audio
            <select id="audioTrackSelect" title="Audio track">
              <option value="default">Default</option>
            </select>
          </label>
          <label>
            Volume
            <input id="volumeRange" type="range" min="0" max="1" step="0.01" value="1" />
          </label>
          <label>
            Seek
            <input id="seekRange" type="range" min="0" max="100" step="0.1" value="0" />
          </label>
          <span id="timeText">00:00 / 00:00</span>
        </section>
      </article>

            <aside class="glass side-card">
        <section class="glass chat-panel">
          <div class="chat-panel-head">
            <h2>Room Chat</h2>
            <div class="voice-actions">
              <button id="joinVoiceBtn" type="button">Join Voice</button>
              <button id="muteVoiceBtn" class="disabled" type="button" disabled>Mute Mic</button>
              <button id="leaveVoiceBtn" class="disabled" type="button" disabled>Leave Voice</button>
              <button id="toggleVideoBtn" class="disabled" type="button" disabled>Enable Cam</button>
            </div>
          </div>
          <p id="voiceStatus" class="voice-status">Voice: Off</p>
          <div id="chatList" class="chat-list"></div>
          <div id="emojiPicker" class="emoji-picker hidden"></div>
          <div class="chat-box">
            <button id="emojiBtn" type="button" title="Insert emoji" aria-label="Emoji picker"><img src="assets/emoji-button.svg" alt="" /></button>
            <input id="chatInput" type="text" maxlength="500" placeholder="Type a message" />
            <button id="sendChatBtn" type="button" aria-label="Send message"><img src="assets/send-button.svg" alt="" /></button>
          </div>
        </section>

        <section class="glass info-panel">
          <h3>Room</h3>
          <p id="roleText">Role: Viewer</p>
          <p id="hostText">Host: -</p>

          <div class="upload-box">
            <label for="uploadInput" id="uploadLabel" class="upload-label">Upload Video (Host Direct)</label>
            <input id="uploadInput" class="hidden-upload" type="file" accept="video/*" />

            <div class="youtube-box">
              <input id="youtubeUrlInput" type="text" placeholder="Paste YouTube URL (Host/Co-host)" />
              <button id="setYoutubeBtn" type="button">Set YouTube</button>
            </div>

            <div class="external-box">
              <input id="externalUrlInput" type="text" placeholder="Paste External URL (Host/Co-host)" />
              <button id="setExternalBtn" type="button">Set External</button>
            </div>
            <div class="external-info">
              <span id="externalProviderBadge" class="external-provider-badge neutral">Provider: -</span>
              <p id="externalValidationText" class="external-validation neutral">Paste a URL to check provider support.</p>
            </div>

            <button id="syncBlobBtn" class="disabled" type="button" disabled>Sync Playlist from Blob</button>

            <div id="uploadProgressWrap" class="upload-progress-wrap hidden">
              <div class="upload-progress-track">
                <div id="uploadProgressFill" class="upload-progress-fill"></div>
              </div>
              <p id="uploadProgressText" class="upload-progress-text">0%</p>
            </div>
            <button id="clearUploadBtn" class="disabled" type="button" disabled>Clear Current Media</button>
          </div>

          <h3>Playlist</h3>
          <ul id="playlistList" class="playlist-list"></ul>

          <h3>Request Queue</h3>
          <ul id="requestQueueList" class="request-queue-list"></ul>

          <h3>Members</h3>
          <ul id="memberList" class="member-list"></ul>
        </section>
      </aside>
    </section>
  </main>


  <section id="camDock" class="cam-dock hidden" aria-label="Video call windows"></section>
  <script src="https://www.youtube.com/iframe_api"></script>
  <script src="/socket.io/socket.io.js"></script>
  <script src="watch-party.js"></script>
</body>
</html>

